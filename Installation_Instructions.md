# Bibliometric Author Analysis

## Requirements

Following are required to run the project.

  * python 2.7 (Python 3 has not yet been tested)
  * pip
  * requests
  * xmltodict
  * pymongo
  * py2neo
  * mongodb database server
  * neo4j database server


## Instructions for setting up the required tools

### Python modules

Note: The instalation has been tested on Ubuntu

We recommend that you use pyenv or virtualenv to make sure you isolate the instalation from your system python. In cas eyou use virtualanv do:

```bash
$ pip install virtualenv
$ mkdir biblio
$ cd biblio
$ virtualenv biblio
$ source biblio/bin/activate
```

Next install the following modules

```bash
$ pip install requests
pip install xmltodict
pip install pymongo
pip install py2neo
```

### MongoDB

You will also need to install pymongo and mongo. The steps to install 'mongodb' can be found in the URL: 

* <http://docs.mongodb.org/manual/installation/>

Please follow the instructions for your particular version of the OS. 

The easiest wahy to manage your mongo instalation is with cloudmesh. However, for now we assume you have installed and run mongo on the defulat port. If you need different configurations, you can customize them in 
`constants/constants.py`

### Neo4j

The steps to install 'neo4j' can be found in the URL: 

* <http://neo4j.com/download/>
   
Please follow the instructions for your particular version of the OS.  Download and install neo4j community edition.
Start the server. (In Mac/Linux, "cd" in terminal to the extracted folder and then enter the command 
   
```bash
$ bin/neo4j start
```

Make sure that you are able to connect to the neo4j server instance at "http://localhost:7474" in a web browser.

## Instructions to run the author bibliometric analysis

It takes around 90-120 minutes to run the project with default settings (on an old computer). It is significantly faster now. 
If you want to skip it, then the graph database generated by running the project is provided under 'Neo4j/default.graphdb' folder. Skip to the last instruction in step 8 if you don't want to run the project.)

1. Download the project and go to the directory:

```bash
$ git clone https://github.com/scienceimpact/bibliometric
cd bibliometric
```

2. Make sure that your mongodb and neo4j server instances are running.
   Make sure that you are able to connect to the default instances of these servers without any user credentials.
   Instructions to these are provided in the above section.

3. The project is setup with default settings. To run the project with these default settings, go to next step.
   If you want to change the default settings, then follow the instructions in the section "Change project settings" 
   before proceeding to the next step.

4. Make sure that you have an active internet connection before running the project.
   The project retrieves the Author and Publication data from ORCID and IEEE websites, parses it in the required format 
   and builds a social network graph on neo4j server with 'authored' relationships between Authors and their Publications.

5. Add the project root folder to PYTHONPATH.
   In Windows, add PYTHONPATH in Environment variables.
   In Linux, add PYTHONPATH to '~/.bash_profile' and then enter the command "source ~/.bash_profile" in terminal.

7. Make sure that you are in the project root folder in the terminal. To run the project, enter the command 

   ```bash
   $ python main/main.py" in terminal.
   ```
   
   Under the default settings, the project runs for 90-120 minutes if you have a stable and fast internet connection.
   If the project runs successfully (on receiving the message `Finished loading data`), then skip the next step and go to step 

8. If the run fails due to an intermittent error, then drop the mongodb and neo4j databases and then rerun the project as in the previous step.
   
   To drop the mongodb database, first connect to mongodb server using the command "mongo"
   In mongo client, enter "show dbs". If the database named 'biblio' is present then drop it using the below commands.
   First enter "use biblio;" and then enter "db.dropDatabase();" in mongo client. This drops the 'biblio' database.
   
   To drop the neo4j database, first stop the neo4j server using the command "bin/neo4j stop" in neo4j extracted folder.
   Delete the 'graph.db' folder under the folder named 'data' in neo4j extracted folder. This drops the default database.
   In case of Windows, the 'graph.db' folder may be in your 'Documents\Neo4j' folder as 'default.graphdb'.
   Again start the server using the command "bin/neo4j start" in neo4j extracted folder.
   
   The generated Neo4j database by running the project is provided under 'Neo4j' folder of the project as 'default.graphdb'.
   In case you don't have an internet connection, copy the contents of this folder 'default.graphdb' to the folder 'graph.db' 
   and restart neo4j server. This loads the database.
   
9. Refresh the Neo4j browser client page "http://localhost:7474". 
   Under the default settings, 270 Author nodes and 2814 Publication nodes with 'authored' Relationships between them are created.

10. Now all the data is loaded into Neo4j. You can run cypher queries on the neo4j browser instance to test the project.
    All the test cypher queries are given in the file 'test_queries.docx'

## Change settings

1. The project settings are either under 'constants/constants.py' file or under 'main/main.py' file in the project folder.

2. By default, the project runs until at least 250 Author nodes are retrieved.
   If you want to change this value, update the value of retrieve_authors_upto_count in 'constants/constants.py' file.
   Note that increasing this value will take more time for the project to run and decreasing this value results in too less data for testing.

3. If you want to change the mongodb connection settings, they can be changed in 'constants/constants.py' file.
   All the variables are under 'mongo_constants' and are self explanatory.
   
4. More options to run the project are provided in 'main/main.py' file. The details are as described in the file.

Note: If you want to re-run the project, then make sure to delete the mongodb and neo4j databases. They are created while running the project. Details on deleting mongodb and neo4j databases are provided in the above section under step 8.
